---
# Please do not edit this file directly; it is auto generated.
# Instead, please edit 06-order.md in _episodes_rmd/
title: "Ordering stuff"
teaching: 10
exercises: 5
questions:
- "FIX ME"
objectives:
- "FIX ME"
keypoints:
- "FIX ME"

source: Rmd
---





# The order of stuff

Previously we made a boxplot:



~~~
diamonds %>% ggplot(aes(carat, y = cut)) +
  geom_boxplot()
~~~
{: .language-r}

<img src="../fig/rmd-04-order_boxplot-1.png" alt="plot of chunk order_boxplot" width="612" style="display: block; margin: auto;" />

Knowing what we know about the order of terms for the quality of the diamonds,
this makes sense. Fair is the lowest quality of the cut, ideal the best.

But what is determining the order in this plot?

If no other information is provided to ggplot, the order will default to a "natural" 
order. With textual information on the y-axis as in this example, that would be
alphabetical order.

Since the order in this plot is not alphabetical, something else is happening.

And that is factors!

## Factors

Factors are the R way of handling categorical variables. Categorical variables,
also known as qualitative variables, are variables that can take on one and only
one, of a limited, usually fixed, number of possible values. 

Classical examples are the roll of a six-sided die, that can only have one of the
possible outcomes of 1, 2, 3, 4, 5 or 6. The role in reproduction for a mammal
can be only female or male. A cell phone is either on or off.

With the data we are working with here, the cut of a diamond can be either
Fair, Good, Very Good, Premium and Ideal. 

These are categorical values. The cut of a diamond falls in to one and only one
of these categories.

Let us take a look at the actual values of the cut variable (of the first 6 
observations) in our dataset:

~~~
head(diamonds$cut)
~~~
{: .language-r}



~~~
[1] Ideal     Premium   Good      Premium   Good      Very Good
Levels: Fair < Good < Very Good < Premium < Ideal
~~~
{: .output}
We see the values. And we also see that these values have *levels*, the six
categorical values that the cut of a diamond can have.

If we try to convert the values of the cut to numerical values, we can see how 
these values are actually stored by R:


~~~
as.numeric(head(diamonds$cut))
~~~
{: .language-r}



~~~
[1] 5 4 2 4 2 3
~~~
{: .output}
R handles categorical values, factors, by assigning an integer to each value.
5 to "ideal", 4 to "Premium", 2 to "Good" etc. These are the values stored.

Associated with these values are *levels*


~~~
levels(diamonds$cut)
~~~
{: .language-r}



~~~
[1] "Fair"      "Good"      "Very Good" "Premium"   "Ideal"    
~~~
{: .output}

And they appear in a specific order. It is this order, that determines the order
of them in the plot.

If we change that order, the order of the categories in the plot also changes.


> ## ordinals
>
> The cut of these diamonds is not only categorical, but also *ordinal*.
> That is, they are not just in a specific order, but one level is "better" than
> another.
> We see that in the output of head(diamonds$cut):
> [1] Ideal     Premium   Good      Premium   Good      Very Good
> Levels: Fair < Good < Very Good < Premium < Ideal
> 
> < indicates that "good" is better than "fair", but worse than "very good".
{: .callout}

The *forcats* library, part of the Tidyverse, contains a collection of functions 
for manipulating factors.

We can change the order of the levels of a factor using functions from the 
*forcats* library.

One way of reordering factors is the fct_relevel() function. We need to
provide the factor we are reordering, and can the specify the order of the
levels. 

Here, we are specifying "Good" and "Ideal". Good will be relevelled to be the 
first level, "Ideal" the second, followed by the rest of the original factor
in their original order:


~~~
fct_relevel(diamonds$cut, "Good", "Ideal") %>% 
  head()
~~~
{: .language-r}



~~~
[1] Ideal     Premium   Good      Premium   Good      Very Good
Levels: Good < Ideal < Fair < Very Good < Premium
~~~
{: .output}
Now the order is changed, because we have specified that the first two levels 
should be "Good", followed by "Ideal".

The forcats library have many other functions for working with factors. 

Regarding plotting in R, the important thing to know is that the order of things
in our plots are typically controlled by the order of factors, and that we can
change that order to suit our needs.

Let us try:

~~~
diamonds %>% 
  mutate(cut = fct_relevel(cut, "Good", "Ideal")) %>% 
  ggplot(aes(carat, y = cut)) +
    geom_boxplot()
~~~
{: .language-r}

<img src="../fig/rmd-04-unnamed-chunk-6-1.png" alt="plot of chunk unnamed-chunk-6" width="612" style="display: block; margin: auto;" />



{% include links.md %}
