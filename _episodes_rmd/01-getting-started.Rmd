---
title: "Getting started"
teaching: 10
exercises: 5
questions:
- "How do we build a ggplot?"
objectives:
- "Get to understand the layers in ggplot2"
- "Make our first plot"
keypoints:
- "Plots in ggplot2 are build by adding layers"

source: Rmd
---

```{r, include = FALSE}
source("../bin/chunk-options.R")
knitr_fig_path("01-")
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## The grammar of graphics

Plotting using ggplot2 is based on "The Grammar of Graphics" 
https://link.springer.com/book/10.1007/0-387-28695-0, a theoretical treatment of how 
to talk about and conceptualize plots by Leland Wilkinson.

That theoretical treatise has been implemented in the package ggplot2

We do not need to know or understand all details of this 620 page book. But some
weird naming conventions follows from this.

What we do need to know, is that based on the grammar of graphics, the layered
structure of a plot using ggplot, is build like this:

```{r eval = F}
ggplot(data = <DATA>) + 
  <GEOM_FUNCTION>(
     mapping = aes(<MAPPINGS>),
     stat = <STAT>, 
     position = <POSITION>
  ) +
  <COORDINATE_FUNCTION> +
  <SCALE_FUNCTION> +
  <FACET_FUNCTION> +
  <THEME_FUNCTION>
```

We are going to cover each element in the following.

## ggplot in it self

The first thing we need to provide for ggplot is some data. We are working with
the diamond dataset:
```{r}
ggplot(data = diamonds)
```
This in itself produces an extremely boring plot. But it is a plot!. What is 
missing is information on what exactly it is in the dataset we are trying to plot.
How should our data be *mapped* to the area of our plot? Or, what should we 
have on the X-axis, and what should be on the Y-axis?

We provide that information to ggplot using the *mapping* argument to the 
ggplot function:
```{r}
ggplot(data = diamonds, mapping = aes(x = carat, y = price))
```


This specifies that we want the carat-value on the x-axis, and the price-value, 
of the diamond on the y-axis. 

We are not actually seeing any data, because we have not specified the way the
individual datapoints should be plotted. But we do se that the axes now have values.
The data has influenced the plot!

We are going to use points, in order to make a classic scatter plot. We do that
by adding a geom_ function to our plot:

```{r}
ggplot(data = diamonds, mapping = aes(x = carat, y = price)) +
  geom_point()
```
Note that in the template shown above, mapping was placed in the <GEOM_FUNCTION>
rather than in the ggplot function. If we place the mapping in the ggplot function
that mapping will be inherited by the functions we add later, unless we specify
something different.

That means that:
```{r eval = F}
ggplot(data = diamonds, mapping = aes(x = carat, y = price)) +
  geom_point()
```

and
```{r eval = F}
ggplot(data = diamonds) +
  geom_point(mapping = aes(x = carat, y = price))
```

will yield the same result.

ggplot2 is a variation on the original grammar of graphics, called *layered grammar
of graphics*, where the individual parts of the plot are added as layers, one
on top of another. The **+** sign adds these layers.

> ## geoms
>
> geom_point() is the function we use to make scatter plots; because points is
> a geometric object. 
> Other geometric objects can be plotted:
> geom_histogram() will plot histograms
> geom_line() will plot lines
>
> All geometries in ggplot2 are named using the pattern geom_
> 
{: .callout}

## The plus sign

The use of the **+** sign allows us to break up the code producing the plot
in multiple lines. This makes it easier to read (and write!) the code producing
the plot. 

Note that the correct placement of **+** and linebreaks are very important.

This code will work:

```{r, eval = F}
ggplot() +
  geom_point()
```


This will not add the new layer and will return an error message:

```{r, eval = F}
ggplot()
  + geom_point()
```

> ## Exercise
> 
> Plot "carat" (the weight of the diamond) against "x" (the length of the diamond).
> Make it a scatterplot
> 
> > ## Solution
> >
> > diamonds %>%
> >   ggplot(aes(carat, x)) +
> >   geom_point()
> > Note that some outliers, probably erroneous data, are discovered. 
> > A length of 0 is highly suspicious. Plots are also useful to reveal this 
> > sort of things!
> {: .solution}
{: .challenge}




{% include links.md %}