---
title: "Plotting with ggplot2"
teaching: 10
exercises: 5
questions:
- "FIX ME"
objectives:
- "FIX ME"
keypoints:
- "FIX ME"

source: Rmd
---

```{r, include = FALSE}
source("../bin/chunk-options.R")
knitr_fig_path("00-")
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

ggplot2 er en (af flere) pakker i R, der understøtter plots.

It provides a programmatic interface to specifying which variables to plot, how to display them, and to adjusting their visual properties.

The structure of plots generated by ggplot2 allows us to change plot type from eg. barplot to scatterplots with only minimal changes. 

og hvis vi ændrer på det underliggende data.

ggplot2 is the package. The funcion is called ggplot(). 

ggplot2 works best with data in a socalled long format, ie one column for 
each (and every) variable, and a row for every observation.

It is highly recommended to structure data in this way.

EKSEMPEL PÅ STRUKTUREN

The simplest ggplot follows this structure:

ggplot(data = <DATA>, mapping = aes(<MAPPINGS>)) +  <GEOM_FUNCTION>()

We begin by binding a specific data frame to our plot:
```{r eval =F}
ggplot(data = diamonds)
```

Then we define an aesthetic mapping of the data, to elements in the plot. We use the helper function aes() for this:

```{r eval=F}
ggplot(data = diamonds, mapping = aes(x = carat, y = price))
```

Here we map the weight of the diamonds to the x-axis, and the price to the y-axis. We can map other variables to other elements of the plot, size, shape or color to mention the three most popular.

This in it self does not return a very interesting plot:
```{r}
ggplot(data = diamonds, mapping = aes(x = carat, y = price))
```

We do get the two scales scaled to the ranges of data we have on the x and y axes.

```{r}
range(diamonds$carat)
```
```{r}
range(diamonds$price)
```
But we have not specified how we want the data plotted.

We add "geoms", the graphical representation of the data in the plot. ggplot2 have a lot of geoms to choose from. We are beginning with these:

- geom_point() makes scatter plots, dot plots etc
- geom_boxplot() makes boxplots
- geom_line() for trendlines, etc

The general naming is relatively intuitive. If geom_histogram makes histograms to take just one example.

Let us make a scatter plot:
```{r}
ggplot(data = diamonds, mapping = aes(x = carat, y = price)) +
  geom_point()
```

Note that we add geoms to our original (boring) plot by using the + operator.

CHALLENGE

Try to plot the price as a function of the table variable, instead of the carat:

SOLUTION
```{r}
ggplot(diamonds, aes(x, price)) + geom_point()
```

The + operator is rather useful, because it allows us to modify existing plots. We can save the very first plot we made in a variable:
```{r}
diamond_plot <- ggplot(data = diamonds, mapping = aes(x = carat, y = price))
```

And then make the scatter plot by adding the relevant geom to it:

```{r}
diamond_plot + geom_point()
```
Anything you put in the ggplot() function can be seen by any geom layers that you add (i.e., these are universal plot settings). This includes the x- and y-axis you set up in aes().
You can also specify aesthetics for a given geom independently of the aesthetics defined globally in the ggplot() function.
The + sign used to add layers must be placed at the end of each line containing a layer. If, instead, the + sign is added in the line before the other layer, ggplot2 will not add the new layer and will return an error message.
You may notice that we sometimes reference ‘ggplot2’ and sometimes ‘ggplot’. To clarify, ‘ggplot2’ is the name of the most recent version of the package. However, any time we call the function itself, it’s just called ‘ggplot’.


# This is the correct syntax for adding layers
surveys_plot +
  geom_point()

# This will not add the new layer and will return an error message
surveys_plot
  + geom_point()


saving plottet.

{% include links.md %}